kneighbors.py
Arguments : Namespace(batch_norm=True, batchsize=256, batchsize_net=0, bias=0.1, bottleneck_dim=192, convolutional_classifier=12, dataset='imagenet64', kneighbors_fraction=0.4, lr_schedule='{0:3e-3,50:3e-4,75:3e-5}', multigpu=False, n_channel_convolution=2048, nepochs=80, no_affine_batch_norm=False, no_cudnn=False, no_jit=False, no_padding=False, normalize_net_outputs=False, num_workers=4, numpy_seed=0, optimizer='SGD', padding_mode='reflect', patches_file='', path_test='/mnt/home/fguth/datasets/imagenet64/out_data_val', path_train='/mnt/home/fguth/datasets/imagenet64/out_data_train', resume='', save_best_model=False, save_model=False, sgd_momentum=0.9, shrink='softshrink', spatialsize_avg_pooling=5, spatialsize_convolution=6, stride_avg_pooling=3, stride_convolution=1, torch_seed=0, weight_decay=0.0, whitening_reg=0.001)
device: cuda
Trainset : (1281159, 64, 64, 3)
patches randomly selected: (2048, 3, 6, 6)
kernel convolution shape: torch.Size([2048, 3, 6, 6])
bias convolution shape: + torch.Size([1, 2048, 1, 1]), - torch.Size([1, 2048, 1, 1])
Net output size: out1 torch.Size([2048, 19, 19]) out2 torch.Size([2048, 19, 19])
Parameters shape [torch.Size([2048]), torch.Size([2048]), torch.Size([2048]), torch.Size([2048]), torch.Size([1000, 192, 12, 12]), torch.Size([1000]), torch.Size([192, 2048, 1, 1]), torch.Size([192]), torch.Size([192, 2048, 1, 1]), torch.Size([192])]
N parameters : 28.444008 millions
optimizing net execution with torch.jit
new lr:0.003
Train, epoch: 0; Loss: 4.96 | Acc: 13.1 ; threshold 0.100
Test, epoch: 0; Loss: 4.53 | Acc: 17.8 @1 35.8 @5 ; threshold 0.100
Best acc (17.766).
Train, epoch: 1; Loss: 4.43 | Acc: 19.2 ; threshold 0.100
Test, epoch: 1; Loss: 4.29 | Acc: 21.0 @1 40.2 @5 ; threshold 0.100
Best acc (20.99).
Train, epoch: 2; Loss: 4.25 | Acc: 21.5 ; threshold 0.100
Test, epoch: 2; Loss: 4.21 | Acc: 22.2 @1 41.7 @5 ; threshold 0.100
Best acc (22.178).
Train, epoch: 3; Loss: 4.14 | Acc: 23.0 ; threshold 0.100
Test, epoch: 3; Loss: 4.11 | Acc: 23.4 @1 43.6 @5 ; threshold 0.100
Best acc (23.35).
Train, epoch: 4; Loss: 4.06 | Acc: 24.1 ; threshold 0.100
Test, epoch: 4; Loss: 4.10 | Acc: 23.9 @1 44.1 @5 ; threshold 0.100
Best acc (23.926).
Train, epoch: 5; Loss: 4.00 | Acc: 25.0 ; threshold 0.100
Test, epoch: 5; Loss: 4.02 | Acc: 25.0 @1 45.2 @5 ; threshold 0.100
Best acc (25.006).
Train, epoch: 6; Loss: 3.94 | Acc: 25.8 ; threshold 0.100
Test, epoch: 6; Loss: 4.00 | Acc: 25.3 @1 45.8 @5 ; threshold 0.100
Best acc (25.348).
Train, epoch: 7; Loss: 3.90 | Acc: 26.4 ; threshold 0.100
Test, epoch: 7; Loss: 3.96 | Acc: 25.9 @1 46.6 @5 ; threshold 0.100
Best acc (25.882).
Train, epoch: 8; Loss: 3.85 | Acc: 27.0 ; threshold 0.100
Test, epoch: 8; Loss: 3.97 | Acc: 26.1 @1 46.4 @5 ; threshold 0.100
Best acc (26.094).
Train, epoch: 9; Loss: 3.82 | Acc: 27.5 ; threshold 0.100
Test, epoch: 9; Loss: 3.92 | Acc: 26.7 @1 47.2 @5 ; threshold 0.100
Best acc (26.696).
Train, epoch: 10; Loss: 3.78 | Acc: 28.0 ; threshold 0.100
Test, epoch: 10; Loss: 3.95 | Acc: 26.3 @1 46.8 @5 ; threshold 0.100
Train, epoch: 11; Loss: 3.75 | Acc: 28.4 ; threshold 0.100
Test, epoch: 11; Loss: 3.92 | Acc: 26.9 @1 47.7 @5 ; threshold 0.100
Best acc (26.874).
Train, epoch: 12; Loss: 3.72 | Acc: 28.8 ; threshold 0.100
Test, epoch: 12; Loss: 3.92 | Acc: 26.9 @1 47.6 @5 ; threshold 0.100
Train, epoch: 13; Loss: 3.70 | Acc: 29.2 ; threshold 0.100
Test, epoch: 13; Loss: 3.87 | Acc: 27.4 @1 48.3 @5 ; threshold 0.100
Best acc (27.39).
Train, epoch: 14; Loss: 3.67 | Acc: 29.5 ; threshold 0.100
Test, epoch: 14; Loss: 3.87 | Acc: 27.4 @1 48.5 @5 ; threshold 0.100
Train, epoch: 15; Loss: 3.65 | Acc: 29.9 ; threshold 0.100
Test, epoch: 15; Loss: 3.85 | Acc: 27.7 @1 48.6 @5 ; threshold 0.100
Best acc (27.748).
Train, epoch: 16; Loss: 3.63 | Acc: 30.2 ; threshold 0.100
Test, epoch: 16; Loss: 3.86 | Acc: 27.7 @1 48.7 @5 ; threshold 0.100
Train, epoch: 17; Loss: 3.61 | Acc: 30.5 ; threshold 0.100
Test, epoch: 17; Loss: 3.82 | Acc: 28.4 @1 49.1 @5 ; threshold 0.100
Best acc (28.45).
Train, epoch: 18; Loss: 3.59 | Acc: 30.8 ; threshold 0.100
Test, epoch: 18; Loss: 3.82 | Acc: 28.4 @1 49.2 @5 ; threshold 0.100
Train, epoch: 19; Loss: 3.57 | Acc: 31.0 ; threshold 0.100
Test, epoch: 19; Loss: 3.86 | Acc: 28.0 @1 48.5 @5 ; threshold 0.100
Train, epoch: 20; Loss: 3.55 | Acc: 31.3 ; threshold 0.100
Test, epoch: 20; Loss: 3.80 | Acc: 28.5 @1 49.6 @5 ; threshold 0.100
Best acc (28.544).
Train, epoch: 21; Loss: 3.53 | Acc: 31.5 ; threshold 0.100
Test, epoch: 21; Loss: 3.80 | Acc: 28.7 @1 49.6 @5 ; threshold 0.100
Best acc (28.66).
Train, epoch: 22; Loss: 3.52 | Acc: 31.7 ; threshold 0.100
Test, epoch: 22; Loss: 3.80 | Acc: 28.5 @1 49.6 @5 ; threshold 0.100
Train, epoch: 23; Loss: 3.50 | Acc: 32.0 ; threshold 0.100
Test, epoch: 23; Loss: 3.79 | Acc: 28.7 @1 49.8 @5 ; threshold 0.100
Best acc (28.716).
Train, epoch: 24; Loss: 3.49 | Acc: 32.2 ; threshold 0.100
Test, epoch: 24; Loss: 3.80 | Acc: 28.9 @1 49.7 @5 ; threshold 0.100
Best acc (28.894).
Train, epoch: 25; Loss: 3.47 | Acc: 32.4 ; threshold 0.100
Test, epoch: 25; Loss: 3.78 | Acc: 29.1 @1 50.0 @5 ; threshold 0.100
Best acc (29.096).
Train, epoch: 26; Loss: 3.46 | Acc: 32.6 ; threshold 0.100
Test, epoch: 26; Loss: 3.77 | Acc: 29.1 @1 49.9 @5 ; threshold 0.100
Train, epoch: 27; Loss: 3.44 | Acc: 32.8 ; threshold 0.100
Test, epoch: 27; Loss: 3.75 | Acc: 29.4 @1 50.4 @5 ; threshold 0.100
Best acc (29.35).
Train, epoch: 28; Loss: 3.43 | Acc: 32.9 ; threshold 0.100
Test, epoch: 28; Loss: 3.73 | Acc: 29.5 @1 50.6 @5 ; threshold 0.100
Best acc (29.5).
Train, epoch: 29; Loss: 3.42 | Acc: 33.1 ; threshold 0.100
Test, epoch: 29; Loss: 3.75 | Acc: 29.5 @1 50.6 @5 ; threshold 0.100
Train, epoch: 30; Loss: 3.41 | Acc: 33.2 ; threshold 0.100
Test, epoch: 30; Loss: 3.74 | Acc: 29.4 @1 50.8 @5 ; threshold 0.100
Train, epoch: 31; Loss: 3.40 | Acc: 33.4 ; threshold 0.100
Test, epoch: 31; Loss: 3.74 | Acc: 29.9 @1 50.8 @5 ; threshold 0.100
Best acc (29.864).
Train, epoch: 32; Loss: 3.38 | Acc: 33.6 ; threshold 0.100
Test, epoch: 32; Loss: 3.73 | Acc: 29.6 @1 50.8 @5 ; threshold 0.100
Train, epoch: 33; Loss: 3.37 | Acc: 33.7 ; threshold 0.100
Test, epoch: 33; Loss: 3.74 | Acc: 29.5 @1 50.4 @5 ; threshold 0.100
Train, epoch: 34; Loss: 3.36 | Acc: 33.9 ; threshold 0.100
Test, epoch: 34; Loss: 3.71 | Acc: 30.1 @1 51.1 @5 ; threshold 0.100
Best acc (30.056).
Train, epoch: 35; Loss: 3.36 | Acc: 34.0 ; threshold 0.100
Test, epoch: 35; Loss: 3.71 | Acc: 29.8 @1 50.8 @5 ; threshold 0.100
Train, epoch: 36; Loss: 3.35 | Acc: 34.1 ; threshold 0.100
Test, epoch: 36; Loss: 3.71 | Acc: 30.0 @1 51.1 @5 ; threshold 0.100
Train, epoch: 37; Loss: 3.33 | Acc: 34.4 ; threshold 0.100
Test, epoch: 37; Loss: 3.71 | Acc: 30.1 @1 51.3 @5 ; threshold 0.100
Best acc (30.148).
Train, epoch: 38; Loss: 3.33 | Acc: 34.4 ; threshold 0.100
Test, epoch: 38; Loss: 3.72 | Acc: 29.9 @1 51.0 @5 ; threshold 0.100
Train, epoch: 39; Loss: 3.32 | Acc: 34.5 ; threshold 0.100
Test, epoch: 39; Loss: 3.72 | Acc: 30.0 @1 51.1 @5 ; threshold 0.100
Train, epoch: 40; Loss: 3.31 | Acc: 34.7 ; threshold 0.100
Test, epoch: 40; Loss: 3.71 | Acc: 29.8 @1 51.0 @5 ; threshold 0.100
Train, epoch: 41; Loss: 3.30 | Acc: 34.8 ; threshold 0.100
Test, epoch: 41; Loss: 3.71 | Acc: 30.0 @1 51.2 @5 ; threshold 0.100
Train, epoch: 42; Loss: 3.30 | Acc: 34.9 ; threshold 0.100
Test, epoch: 42; Loss: 3.70 | Acc: 30.4 @1 51.4 @5 ; threshold 0.100
Best acc (30.36).
Train, epoch: 43; Loss: 3.29 | Acc: 35.0 ; threshold 0.100
Test, epoch: 43; Loss: 3.68 | Acc: 30.4 @1 51.5 @5 ; threshold 0.100
Best acc (30.4).
Train, epoch: 44; Loss: 3.28 | Acc: 35.1 ; threshold 0.100
Test, epoch: 44; Loss: 3.69 | Acc: 30.3 @1 51.2 @5 ; threshold 0.100
Train, epoch: 45; Loss: 3.28 | Acc: 35.2 ; threshold 0.100
Test, epoch: 45; Loss: 3.70 | Acc: 30.4 @1 51.3 @5 ; threshold 0.100
Train, epoch: 46; Loss: 3.27 | Acc: 35.3 ; threshold 0.100
Test, epoch: 46; Loss: 3.68 | Acc: 30.5 @1 51.6 @5 ; threshold 0.100
Best acc (30.464).
Train, epoch: 47; Loss: 3.26 | Acc: 35.4 ; threshold 0.100
Test, epoch: 47; Loss: 3.68 | Acc: 30.5 @1 51.7 @5 ; threshold 0.100
Train, epoch: 48; Loss: 3.26 | Acc: 35.5 ; threshold 0.100
Test, epoch: 48; Loss: 3.70 | Acc: 30.3 @1 51.3 @5 ; threshold 0.100
Train, epoch: 49; Loss: 3.25 | Acc: 35.6 ; threshold 0.100
Test, epoch: 49; Loss: 3.70 | Acc: 30.4 @1 51.3 @5 ; threshold 0.100
new lr:0.0003
Train, epoch: 50; Loss: 3.02 | Acc: 39.4 ; threshold 0.100
Test, epoch: 50; Loss: 3.51 | Acc: 32.8 @1 53.9 @5 ; threshold 0.100
Best acc (32.752).
Train, epoch: 51; Loss: 3.00 | Acc: 39.8 ; threshold 0.100
Test, epoch: 51; Loss: 3.51 | Acc: 32.9 @1 54.2 @5 ; threshold 0.100
Best acc (32.86).
Train, epoch: 52; Loss: 2.99 | Acc: 40.0 ; threshold 0.100
Test, epoch: 52; Loss: 3.51 | Acc: 33.0 @1 54.2 @5 ; threshold 0.100
Best acc (32.952).
Train, epoch: 53; Loss: 2.98 | Acc: 40.1 ; threshold 0.100
Test, epoch: 53; Loss: 3.50 | Acc: 33.0 @1 54.3 @5 ; threshold 0.100
Best acc (33.006).
Train, epoch: 54; Loss: 2.98 | Acc: 40.2 ; threshold 0.100
Test, epoch: 54; Loss: 3.51 | Acc: 32.9 @1 54.2 @5 ; threshold 0.100
Train, epoch: 55; Loss: 2.97 | Acc: 40.2 ; threshold 0.100
Test, epoch: 55; Loss: 3.51 | Acc: 33.0 @1 54.1 @5 ; threshold 0.100
Train, epoch: 56; Loss: 2.97 | Acc: 40.3 ; threshold 0.100
Test, epoch: 56; Loss: 3.51 | Acc: 33.0 @1 54.2 @5 ; threshold 0.100
Best acc (33.01).
Train, epoch: 57; Loss: 2.97 | Acc: 40.3 ; threshold 0.100
Test, epoch: 57; Loss: 3.51 | Acc: 32.9 @1 54.2 @5 ; threshold 0.100
Train, epoch: 58; Loss: 2.96 | Acc: 40.4 ; threshold 0.100
Test, epoch: 58; Loss: 3.51 | Acc: 33.0 @1 54.2 @5 ; threshold 0.100
Train, epoch: 59; Loss: 2.96 | Acc: 40.4 ; threshold 0.100
Test, epoch: 59; Loss: 3.51 | Acc: 32.9 @1 54.3 @5 ; threshold 0.100
Train, epoch: 60; Loss: 2.96 | Acc: 40.4 ; threshold 0.100
Test, epoch: 60; Loss: 3.51 | Acc: 32.9 @1 54.1 @5 ; threshold 0.100
Train, epoch: 61; Loss: 2.96 | Acc: 40.5 ; threshold 0.100
Test, epoch: 61; Loss: 3.51 | Acc: 33.0 @1 54.2 @5 ; threshold 0.100
Train, epoch: 62; Loss: 2.96 | Acc: 40.5 ; threshold 0.100
Test, epoch: 62; Loss: 3.51 | Acc: 32.9 @1 54.2 @5 ; threshold 0.100
Train, epoch: 63; Loss: 2.95 | Acc: 40.5 ; threshold 0.100
Test, epoch: 63; Loss: 3.52 | Acc: 32.9 @1 54.2 @5 ; threshold 0.100
Train, epoch: 64; Loss: 2.95 | Acc: 40.5 ; threshold 0.100
Test, epoch: 64; Loss: 3.51 | Acc: 32.8 @1 54.3 @5 ; threshold 0.100
Train, epoch: 65; Loss: 2.95 | Acc: 40.6 ; threshold 0.100
Test, epoch: 65; Loss: 3.52 | Acc: 33.0 @1 54.2 @5 ; threshold 0.100
Train, epoch: 66; Loss: 2.95 | Acc: 40.6 ; threshold 0.100
Test, epoch: 66; Loss: 3.52 | Acc: 32.9 @1 54.1 @5 ; threshold 0.100
Train, epoch: 67; Loss: 2.95 | Acc: 40.6 ; threshold 0.100
Test, epoch: 67; Loss: 3.52 | Acc: 33.0 @1 54.3 @5 ; threshold 0.100
Train, epoch: 68; Loss: 2.95 | Acc: 40.6 ; threshold 0.100
Test, epoch: 68; Loss: 3.52 | Acc: 32.9 @1 54.1 @5 ; threshold 0.100
Train, epoch: 69; Loss: 2.94 | Acc: 40.6 ; threshold 0.100
Test, epoch: 69; Loss: 3.52 | Acc: 33.0 @1 54.2 @5 ; threshold 0.100
Best acc (33.028).
Train, epoch: 70; Loss: 2.94 | Acc: 40.7 ; threshold 0.100
Test, epoch: 70; Loss: 3.52 | Acc: 33.0 @1 54.1 @5 ; threshold 0.100
Train, epoch: 71; Loss: 2.94 | Acc: 40.7 ; threshold 0.100
Test, epoch: 71; Loss: 3.52 | Acc: 33.1 @1 54.2 @5 ; threshold 0.100
Best acc (33.066).
Train, epoch: 72; Loss: 2.94 | Acc: 40.6 ; threshold 0.100
Test, epoch: 72; Loss: 3.52 | Acc: 33.1 @1 54.1 @5 ; threshold 0.100
Best acc (33.12).
Train, epoch: 73; Loss: 2.94 | Acc: 40.7 ; threshold 0.100
Test, epoch: 73; Loss: 3.52 | Acc: 32.9 @1 54.2 @5 ; threshold 0.100
Train, epoch: 74; Loss: 2.94 | Acc: 40.7 ; threshold 0.100
Test, epoch: 74; Loss: 3.53 | Acc: 33.0 @1 54.2 @5 ; threshold 0.100
new lr:3e-05
Train, epoch: 75; Loss: 2.91 | Acc: 41.2 ; threshold 0.100
Test, epoch: 75; Loss: 3.51 | Acc: 33.2 @1 54.4 @5 ; threshold 0.100
Best acc (33.21).
Train, epoch: 76; Loss: 2.91 | Acc: 41.2 ; threshold 0.100
Test, epoch: 76; Loss: 3.51 | Acc: 33.2 @1 54.4 @5 ; threshold 0.100
Train, epoch: 77; Loss: 2.91 | Acc: 41.3 ; threshold 0.100
Test, epoch: 77; Loss: 3.51 | Acc: 33.2 @1 54.4 @5 ; threshold 0.100
Train, epoch: 78; Loss: 2.91 | Acc: 41.2 ; threshold 0.100
Test, epoch: 78; Loss: 3.51 | Acc: 33.2 @1 54.4 @5 ; threshold 0.100
Train, epoch: 79; Loss: 2.91 | Acc: 41.3 ; threshold 0.100
Test, epoch: 79; Loss: 3.51 | Acc: 33.2 @1 54.4 @5 ; threshold 0.100
Best acc (33.214).
Best test acc. 33.214  at epoch 79/79
Done in 89.7 hours with 1 GPU
